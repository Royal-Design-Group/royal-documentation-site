
<!doctype html>
<html>
  <head>
    <link href="images/favicon-ef46b48e.ico?1630277901" rel="icon" type="image/ico" />
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for the mono-repo royal-web containing the front-end code for RoyalDesign and Rum21"
        >
    <title>Documentation royalweb frontend</title>

            

    <style media="screen">

      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight {
  color: #faf6e4;
  background-color: #122b3b;
}
.highlight .gl {
  color: #dee5e7;
  background-color: #4e5d62;
}
.highlight .gp {
  color: #a8e1fe;
  font-weight: bold;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #6c8b9f;
  font-style: italic;
}
.highlight .cp {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .err {
  color: #fefeec;
  background-color: #cc0000;
}
.highlight .gr {
  color: #cc0000;
  font-weight: bold;
  font-style: italic;
}
.highlight .k, .highlight .kd, .highlight .kv {
  color: #f6dd62;
  font-weight: bold;
}
.highlight .o, .highlight .ow {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .p, .highlight .pi {
  color: #4df4ff;
}
.highlight .gd {
  color: #cc0000;
}
.highlight .gi {
  color: #b2fd6d;
}
.highlight .ge {
  font-style: italic;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gt {
  color: #dee5e7;
  background-color: #4e5d62;
}
.highlight .kc {
  color: #f696db;
  font-weight: bold;
}
.highlight .kn {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kp {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kr {
  color: #ffb000;
  font-weight: bold;
}
.highlight .gh {
  color: #ffb000;
  font-weight: bold;
}
.highlight .gu {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kt {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .no {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nc {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nd {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nn {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .bp {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .ne {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nl {
  color: #ffb000;
  font-weight: bold;
}
.highlight .nt {
  color: #ffb000;
  font-weight: bold;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #f696db;
  font-weight: bold;
}
.highlight .ld {
  color: #f696db;
  font-weight: bold;
}
.highlight .ss {
  color: #f696db;
  font-weight: bold;
}
.highlight .s, .highlight .sb, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .sr, .highlight .s1 {
  color: #fff0a6;
  font-weight: bold;
}
.highlight .sa {
  color: #f6dd62;
  font-weight: bold;
}
.highlight .se {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .sc {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .si {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .nb {
  font-weight: bold;
}
.highlight .ni {
  color: #999999;
  font-weight: bold;
}
.highlight .w {
  color: #BBBBBB;
}
.highlight .go {
  color: #BBBBBB;
}
.highlight .nf, .highlight .fm {
  color: #a8e1fe;
}
.highlight .py {
  color: #a8e1fe;
}
.highlight .na {
  color: #a8e1fe;
}
.highlight .nv, .highlight .vc, .highlight .vg, .highlight .vi, .highlight .vm {
  color: #a8e1fe;
  font-weight: bold;
}


    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>

    <link href="stylesheets/screen-761b3157.css?1630277901" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-efed1d22.css?1630277901" rel="stylesheet" media="print" />
      <script src="javascripts/all-b12a2749.js?1630277901"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript&quot;,&quot;html&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png?1630277901" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-c9cd7623.png?1630277901" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="html">html</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#royal-web" class="toc-h1 toc-link" data-title="Royal web">Royal web</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#projects" class="toc-h2 toc-link" data-title="projects">projects</a>
                  </li>
                  <li>
                    <a href="#setup" class="toc-h2 toc-link" data-title="Setup">Setup</a>
                  </li>
                  <li>
                    <a href="#translation-flow" class="toc-h2 toc-link" data-title="Translation flow">Translation flow</a>
                  </li>
                  <li>
                    <a href="#adding-a-new-site" class="toc-h2 toc-link" data-title="Adding a new site">Adding a new site</a>
                  </li>
                  <li>
                    <a href="#ci-cd" class="toc-h2 toc-link" data-title="CI/CD">CI/CD</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#housekeeping" class="toc-h1 toc-link" data-title="Housekeeping">Housekeeping</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#updating-react-scripts-fork" class="toc-h2 toc-link" data-title="Updating react-scripts fork">Updating react-scripts fork</a>
                  </li>
                  <li>
                    <a href="#development" class="toc-h2 toc-link" data-title="Development">Development</a>
                  </li>
                  <li>
                    <a href="#files-and-folders" class="toc-h2 toc-link" data-title="Files and folders">Files and folders</a>
                  </li>
                  <li>
                    <a href="#available-scripts" class="toc-h2 toc-link" data-title="Available Scripts">Available Scripts</a>
                  </li>
                  <li>
                    <a href="#styling" class="toc-h2 toc-link" data-title="Styling">Styling</a>
                  </li>
                  <li>
                    <a href="#supported-language-features-and-polyfills" class="toc-h2 toc-link" data-title="Supported Language Features and Polyfills">Supported Language Features and Polyfills</a>
                  </li>
                  <li>
                    <a href="#formatting-code-automatically" class="toc-h2 toc-link" data-title="Formatting Code Automatically">Formatting Code Automatically</a>
                  </li>
                  <li>
                    <a href="#installing-a-dependency" class="toc-h2 toc-link" data-title="Installing a Dependency">Installing a Dependency</a>
                  </li>
                  <li>
                    <a href="#adding-images-fonts-and-files" class="toc-h2 toc-link" data-title="Adding Images, Fonts, and Files">Adding Images, Fonts, and Files</a>
                  </li>
                  <li>
                    <a href="#using-the-public-folder" class="toc-h2 toc-link" data-title="Using the public Folder">Using the <code>public</code> Folder</a>
                  </li>
                  <li>
                    <a href="#using-global-variables" class="toc-h2 toc-link" data-title="Using Global Variables">Using Global Variables</a>
                  </li>
                  <li>
                    <a href="#using-https-in-development" class="toc-h2 toc-link" data-title="Using HTTPS in Development">Using HTTPS in Development</a>
                  </li>
                  <li>
                    <a href="#running-tests" class="toc-h2 toc-link" data-title="Running Tests">Running Tests</a>
                  </li>
                  <li>
                    <a href="#analyzing-the-bundle-size" class="toc-h2 toc-link" data-title="Analyzing the Bundle Size">Analyzing the Bundle Size</a>
                  </li>
                  <li>
                    <a href="#advanced-configuration" class="toc-h2 toc-link" data-title="Advanced Configuration">Advanced Configuration</a>
                  </li>
                  <li>
                    <a href="#troubleshooting" class="toc-h2 toc-link" data-title="Troubleshooting">Troubleshooting</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#react-scripts" class="toc-h1 toc-link" data-title="React scripts">React scripts</a>
          </li>
          <li>
            <a href="#enviroments" class="toc-h1 toc-link" data-title="Enviroments">Enviroments</a>
          </li>
          <li>
            <a href="#meta-tags" class="toc-h1 toc-link" data-title="Meta tags">Meta tags</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#head" class="toc-h2 toc-link" data-title="Head">Head</a>
                  </li>
                  <li>
                    <a href="#google-tag-mananger-gtm" class="toc-h2 toc-link" data-title="Google tag mananger - GTM">Google tag mananger - GTM</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#verify-deploys" class="toc-h1 toc-link" data-title="Verify deploys">Verify deploys</a>
          </li>
          <li>
            <a href="#documentation-in-swedish" class="toc-h1 toc-link" data-title="Documentation in swedish">Documentation in swedish</a>
          </li>
          <li>
            <a href="#collector" class="toc-h1 toc-link" data-title="Collector">Collector</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#i-stage-miljoer" class="toc-h2 toc-link" data-title="I stage miljöer">I stage miljöer</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/2lach'These docs where</a></li>
            <li><a href='https://github.com/2lach'>Created by Stefan</a></li>
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='royal-web'>Royal web</h1>
<p>This package contains the main code for the Royal Design website/React app. It is based on <a href="https://github.com/facebookincubator/create-react-app">Create React App</a> but is using a custom fork of the <code>react-scripts</code> package, found in this monorepo.</p>
<h2 id='projects'>projects</h2>
<p><a href="https://github.com/Royal-Design-Group/royal-web">Github</a>
<a href="https://bitbucket.org/grebban/royal-web/src/develop/">Bitbucket</a></p>
<h2 id='setup'>Setup</h2>
<p>Make sure you have <a href="https://yarnpkg.com/en/docs/install">yarn</a> installed.</p>

<p>Open a terminal and install dependencies:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn
</code></pre></div>
<p>Change into the royaldesign package folder:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">cd </span>packages/royaldesign
</code></pre></div>
<p>Run development server:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn start
</code></pre></div>
<p>Build production client and server bundle:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn build
</code></pre></div>
<p>Run production server:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn serve
</code></pre></div><h3 id='build-with-a-specific-locale'>Build with a specific locale</h3>
<p>By default the build is using the default locale specified in config.json of the royaldesign package root. To override this, set the env-var LOCALE when building for production:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nv">LOCALE</span><span class="o">=</span>en-US yarn build
</code></pre></div><h2 id='translation-flow'>Translation flow</h2>
<p>If you have added new strings to an application you can extract the strings to the default locale file (sv-SE) using this command:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn translations extract
</code></pre></div>
<p>If you look at you git diff you should be able to identify any new strings that have been added to the application.</p>

<p>To get them translated we use a Google Drive document to communicate translations with Royal Design. We input the id (the key generated to JSON file, like ange_rabattkod_fa2f75f7) and the swedish string and they will make sure that their resources for translations will fill the rest of the columns. We then manually just add the translations to the other locale files after we have received the translations. If you have a large amount of strings there is an old script somewhere that Niclas Vänström can dig up.</p>

<p>So add any new strings to the sheet for the application and ping Isabelle Blanc in the Royal Design Slack about the fact that we need translations.</p>

<p><a href="https://docs.google.com/spreadsheets/d/1XjzXfH6_d8k9AXVua-9GpHpwDxtzk6Mah8r7Zb5tjAY/">Link to the google spreadsheets</a></p>
<h2 id='adding-a-new-site'>Adding a new site</h2>
<p>When adding a new site there are some steps that you need to go through:</p>

<ul>
<li>If you are adding a new currency. Add the format to src/constants/format.js</li>
<li>Configure routing in src/lib/routing/config.js</li>
<li>Add locale to src/config.json</li>
<li>Create a translated locale file (preferably based on sv-SE if possible) and add it to translations/{new_locale}.json</li>
<li>Create new env files in the env folder in the root</li>
</ul>
<h2 id='ci-cd'>CI/CD</h2>
<p>There are currently some basic build and release pipelines for the royal-web repository. So whenever you push to a release branch a build based on the file Dockerfile-VSTS will be triggered, if the build is successful it will be automatically deployed to the staging environment which consists of these sites:</p>

<p>https://royalweb-no-stage.azurewebsites.net
https://royalweb-se-stage.azurewebsites.net</p>

<p>and for the rest of all royaldesign and rum21 domains with the
https://royalweb-&quot;LOCALE&quot;-stage.azurewebsites.net - LOCALE being the only change</p>

<p>As a safety precaution deploying the release to the live environment is done by manually approving a release (just a click in VSTS given that you have the correct credentials). And they will end up on these URLs:</p>
<h3 id='royaldesign'>royaldesign</h3>
<p>Royal SE - 
  https://royalweb-se-prod-deploy.azurewebsites.net</p>

<p>Royal FI - 
  https://royalweb-fi-prod-deploy.azurewebsites.net</p>

<p>Royal NO - 
  https://royalweb-no-prod-deploy.azurewebsites.net</p>

<p>Royal DK - 
  https://royalweb-dk-prod-deploy.azurewebsites.net</p>

<p>Royal DE - 
  https://royalweb-de-prod-deploy.azurewebsites.net</p>

<p>Royal JP - 
  https://royalweb-jp-prod-deploy.azurewebsites.net</p>

<p>Royal UK - 
  https://royalweb-uk-prod-deploy.azurewebsites.net</p>

<p>Royal KR - 
  https://royalweb-kr-prod-deploy.azurewebsites.net</p>

<p>Royal CH - 
  https://royalweb-ch-prod-deploy.azurewebsites.net</p>

<p>Royal US - 
  https://royalweb-us-prod-deploy.azurewebsites.net</p>

<p>Royal EU - 
  https://royalweb-eu-prod-deploy.azurewebsites.net</p>

<p>Royal AU - 
  https://royalweb-au-prod-deploy.azurewebsites.net</p>

<p>Royal AT - 
  https://royalweb-at-prod-deploy.azurewebsites.net</p>

<p>Royal NL - 
  https://royalweb-nl-prod-royalweb-nl-prod-deploy.azurewebsites.net</p>
<h3 id='rum21'>rum21</h3>
<p>Rum21 SE - 
  https://r21web-se-prod-deploy.azurewebsites.net</p>

<p>Rum21 NO - 
  https://r21web-no-prod-deploy.azurewebsites.net</p>

<p>Rum21 FI - 
  https://r21web-fi-prod-deploy.azurewebsites.net</p>

<p>Rum21 DK - 
  https://r21web-dk-prod-deploy.azurewebsites.net</p>
<h1 id='housekeeping'>Housekeeping</h1><h2 id='updating-react-scripts-fork'>Updating react-scripts fork</h2><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># check out create-react-app repo</span>
<span class="nv">$ </span>git clone git@github.com:facebookincubator/create-react-app.git
<span class="nv">$ </span><span class="nb">cd </span>create-react-app

<span class="c"># checkout the branch/tag you want to update to</span>
<span class="nv">$ </span>git checkout v1.0.17

<span class="c"># make subtree split to get a branch called react-scripts-v1.0.17 containing</span>
<span class="c"># only the react-scripts package</span>
<span class="nv">$ </span>git subtree <span class="nb">split</span> <span class="nt">-P</span> packages/react-scripts <span class="nt">-b</span> react-scripts-v1.0.17

<span class="c"># go to royal-web repo</span>
<span class="nv">$ </span><span class="nb">cd</span> ../royal-web

<span class="c"># add our create-react-app clone as a new remote. you only need to do this the first time</span>
<span class="nv">$ </span>git remote add react-scripts-origin ../create-react-app

<span class="c"># merge the changes made to react-scripts origin</span>
<span class="nv">$ </span>git subtree pull <span class="nt">-P</span> packages/react-scripts react-scripts-origin react-scripts-v1.0.17 <span class="nt">--squash</span>
</code></pre></div>
<p>For more info, check out <a href="https://gist.github.com/alfredringstad/ac0f7a1e081e9ee485e653b6a8351212">this gist</a></p>
<h2 id='development'>Development</h2><h3 id='start-dev-server'>Start dev server</h3>
<p>Launch the dev server by following instructions in the README found in the monorepo root, or open a terminal in this folder and run
<code>yarn start</code></p>

<p>Your browser should automatically open and load the React app.</p>
<h3 id='folder-structure'>Folder Structure</h3>
<p>The folder structure is based on the one generated by <code>create-react-app</code> but introduces some more structure.</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>royaldesign/
  README.md
  config.json
  locales/
    sv-SE.json
    ...
  node_modules/
  package.json
  public/
    index.html
    favicon.ico
    manifest.json
  src/
    client.js
    index.js
    server.js
    components/
      UI/
      App.js
    lib/
    store/
</code></pre></div><h2 id='files-and-folders'>Files and folders</h2><h4 id='readme-md'>README.md</h4>
<p>This file. Contains instructions for development/building of this app, as well as how the code is organized. Should be updated when adding bigger features or making decisions with big impact.</p>
<h4 id='config-json'>config.json</h4>
<p>A static config file, used in <code>react-scripts</code>. This is currently used to set up the translation tools - to let us know which locale is used in the inline translations inside the code, and which other locales that are available.</p>
<h4 id='locales'>locales/</h4>
<p>Folder containing the translation strings used when building the app. By default, the translations are written in Swedish inside the code. When using the <code>yarn translations extract</code> command, the translation strings are extracted into <code>sv-SE.json</code>. This file can then be used as a base for making translations.</p>
<h4 id='node_modules'>node_modules/</h4>
<p>Contains all dependencies. Should never be committed.</p>
<h4 id='package-json'>package.json</h4>
<p>Contains dependency list as well as available yarn/npm commands. Handles versioning of other packages in this repo, meaning we could update the fork of react-scripts and add new features, but still pin the dependency to an older version if we&#39;d like.</p>
<h4 id='public'>public/</h4>
<p>Contains assets that are made statically available from the express server. Normally, you would not touch these files or add images/stylesheets/js-files here, but instead import these in files used in <code>src/</code>. Sometimes, however, this is necessary.</p>
<h4 id='index-html'>index.html</h4>
<p>Main HTML template for the site. Needs to contain an element with the id <code>root</code> in order for the React app to mount correctly.</p>
<h4 id='facicon-ico'>facicon.ico</h4>
<p>Favicon for the site.</p>
<h4 id='manifest-json'>manifest.json</h4>
<p>Web manifest used mainly on mobile phones when saving the app to the home screen (progressive web app).</p>
<h4 id='src'>src/</h4>
<p>Contains all source code for the React app.</p>
<h4 id='components'>components/</h4>
<p>Contains all React components used in the app.</p>
<h5 id='ui'>UI/</h5>
<p>Contains shared UI components (buttons, headers, paragraphs etc)</p>
<h5 id='app-js'>App.js</h5>
<p>Entry point for React.</p>
<h4 id='lib'>lib/</h4>
<p>Helper files/API abstractions etc.</p>
<h4 id='store'>store/</h4>
<p>Reducers and store files used with Redux.</p>
<h4 id='actions'>actions/</h4>
<p>Action creators used with Redux.</p>
<h4 id='index-js'>index.js</h4>
<p>Main entry file. Renders <App> component with the correct rendering method on client and server.</p>
<h4 id='client-js'>client.js</h4>
<p>Exports rendering function used in browser. Can be used to import code that should only be run on the client (e.g. service worker registration).</p>
<h4 id='server-js'>server.js</h4>
<p>Exports rendering function used in server. Receives the template (index.html) and <code>react-loadable</code> stats from the wrapper around the <code>serve</code> command. Is used as an express middleware.</p>
<h4 id='constants-js'>constants.js</h4>
<p>Constants used within the app.</p>
<h2 id='available-scripts'>Available Scripts</h2>
<p>In the project directory, you can run:</p>
<h3 id='yarn-start'><code>yarn start</code></h3>
<p>Runs the app in the development mode.<br>
Open <a href="http://localhost:3000">http://localhost:3000</a> to view it in the browser.</p>

<p>The page will reload if you make edits.<br>
You will also see any lint errors in the console.</p>
<h3 id='yarn-test'><code>yarn test</code></h3>
<p>Launches the test runner in the interactive watch mode.<br>
See the section about <a href="#running-tests">running tests</a> for more information.</p>
<h3 id='yarn-build'><code>yarn build</code></h3>
<p>Builds the app for production to the <code>build</code> folder.<br>
It correctly bundles React in production mode and optimizes the build for the best performance.</p>

<p>The build is minified and the filenames include the hashes.<br>
Your app is ready to be deployed!</p>

<p>See the section about <a href="#deployment">deployment</a> for more information.</p>
<h3 id='yarn-serve'><code>yarn serve</code></h3>
<p>Starts an express server that serves the JS bundle and does server side rendering. Note that you have to run <code>yarn build</code> first.</p>
<h3 id='yarn-translations'><code>yarn translations</code></h3>
<p>Tools for working with translations.</p>
<h4 id='yarn-translations-extract'><code>yarn translations extract</code></h4>
<p>Extracts translations from all JS files inside the <code>src/</code>-folder and outputs into the default locale file inside <code>locales/</code>.</p>

<p>The <code>translations.default</code> value in <code>config.json</code> determines which locale is default.</p>
<h4 id='yarn-translations-lint'><code>yarn translations lint</code></h4>
<p>Runs lint on all translations specified in <code>translations.locales</code> of <code>config.json</code> and shows any errors or warnings.</p>
<h3 id='yarn-run'><code>yarn run</code></h3>
<p>will give you an overview of the available commands.</p>

<blockquote>
<p>Which command would you like to run?</p>
</blockquote>
<h2 id='styling'>Styling</h2>
<p>This project includes some packages to assist with styling components.</p>
<h3 id='css-in-js'>CSS-in-JS</h3>
<p><a href="https://github.com/emotion-js/emotion">Emotion</a> is used to style components and avoid specificity issues with CSS. It allows us to abstract CSS to the component level rather than maintaining global stylesheets.</p>
<h3 id='grid-system'>Grid System</h3>
<p>In order to keep padding, margin, and positioning consistent, we use <a href="https://github.com/emotion-js/grid-emotion">grid-emotion</a>, which is the Emotion-based implementation of <a href="https://github.com/jxnblk/grid-styled#readme">grid-styled</a>. This is a responsive grid library that makes use of the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">Flexible Box Module</a> and exposes a <code>Flex</code> component and a <code>Box</code> component.</p>

<p><code>Box</code> has margin and padding props that accept a number from <code>0-4</code>, representing a step on the spacing scale. This allows us to keep all margins and paddings consistent, and is the preferred way to define spacing. Negative numbers may also be used to set a negative margin.</p>

<p><code>Box</code> also has a width prop, which can be used to easily create a grid when used within a <code>Flex</code> componenent. See the <a href="https://github.com/jxnblk/grid-styled#box-">Box docs</a> for full implementation details.</p>

<p><code>Flex</code> extends <code>Box</code>, but sets display to flex automatically. It includes props to set flex alignment, justification, direction etc. See <a href="https://github.com/jxnblk/grid-styled#flex-">Flex docs</a>.</p>

<p>Note that for both components the default underlying DOM element created is a <code>div</code>. This can be changed by passing an element type via the <code>is</code> prop (e.g.) <code>&lt;Box is=&quot;nav&quot; /&gt;</code> will create a <code>&lt;nav&gt;</code> DOM element.</p>
<h2 id='supported-language-features-and-polyfills'>Supported Language Features and Polyfills</h2>
<p>This project supports a superset of the latest JavaScript standard.<br>
In addition to <a href="https://github.com/lukehoban/es6features">ES6</a> syntax features, it also supports:</p>

<ul>
<li><a href="https://github.com/rwaldron/exponentiation-operator">Exponentiation Operator</a> (ES2016).</li>
<li><a href="https://github.com/tc39/ecmascript-asyncawait">Async/await</a> (ES2017).</li>
<li><a href="https://github.com/sebmarkbage/ecmascript-rest-spread">Object Rest/Spread Properties</a> (stage 3 proposal).</li>
<li><a href="https://github.com/tc39/proposal-dynamic-import">Dynamic import()</a> (stage 3 proposal)</li>
<li><a href="https://github.com/tc39/proposal-class-public-fields">Class Fields and Static Properties</a> (part of stage 3 proposal).</li>
<li><a href="https://facebook.github.io/react/docs/introducing-jsx.html">JSX</a> and <a href="https://flowtype.org/">Flow</a> syntax.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">Optional chaining</a> syntax. <a href="stage%204%20proposal">https://github.com/tc39/proposal-optional-chaining</a></li>
</ul>

<p>Learn more about <a href="https://babeljs.io/docs/plugins/#presets-stage-x-experimental-presets-">different proposal stages</a>.</p>

<p>While we recommend using experimental proposals with some caution, Facebook heavily uses these features in the product code, so we intend to provide <a href="https://medium.com/@cpojer/effective-javascript-codemods-5a6686bb46fb">codemods</a> if any of these proposals change in the future.</p>

<p>Note that <strong>the project only includes a few ES6 <a href="https://en.wikipedia.org/wiki/Polyfill">polyfills</a></strong>:</p>

<ul>
<li><a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign"><code>Object.assign()</code></a> via <a href="https://github.com/sindresorhus/object-assign"><code>object-assign</code></a>.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> via <a href="https://github.com/then/promise"><code>promise</code></a>.</li>
<li><a href="https://developer.mozilla.org/en/docs/Web/API/Fetch_API"><code>fetch()</code></a> via <a href="https://github.com/github/fetch"><code>whatwg-fetch</code></a>.</li>
</ul>

<p>If you use any other ES6+ features that need <strong>runtime support</strong> (such as <code>Array.from()</code> or <code>Symbol</code>), make sure you are including the appropriate polyfills manually, or that the browsers you are targeting already support them.</p>
<h2 id='formatting-code-automatically'>Formatting Code Automatically</h2>
<p>Prettier is an opinionated code formatter with support for JavaScript, CSS and JSON. With Prettier you can format the code you write automatically to ensure a code style within your project. See the <a href="https://github.com/prettier/prettier">Prettier&#39;s GitHub page</a> for more information, and look at this <a href="https://prettier.github.io/prettier/">page to see it in action</a>.</p>

<p>The whole monorepo is set up so that when you commit any js/json/md-files they will automatically be formatted with prettier.</p>

<p>You might also want to integrate Prettier in your favorite editor. Read the section on <a href="https://github.com/prettier/prettier#editor-integration">Editor Integration</a> on the Prettier GitHub page.</p>
<h2 id='installing-a-dependency'>Installing a Dependency</h2>
<p>To add a dependency (e.g. react) you simply run</p>

<p><code>yarn add react</code></p>

<p>Yarn will take care of putting the dependency in the correct <code>node_modules/</code>-folder as well as updating the <code>yarn.lock</code> file in the monorepo root. Make sure you commit this file after adding dependencies.</p>
<h2 id='adding-images-fonts-and-files'>Adding Images, Fonts, and Files</h2>
<p>With Webpack, using static assets like images and fonts works similarly to CSS.</p>

<p>You can <strong><code>import</code> a file right in a JavaScript module</strong>. This tells Webpack to include that file in the bundle. Unlike CSS imports, importing a file gives you a string value. This value is the final path you can reference in your code, e.g. as the <code>src</code> attribute of an image or the <code>href</code> of a link to a PDF.</p>

<p>To reduce the number of requests to the server, importing images that are less than 10,000 bytes returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">data URI</a> instead of a path. This applies to the following file extensions: bmp, gif, jpg, jpeg, and png. SVG files are excluded due to <a href="https://github.com/facebookincubator/create-react-app/issues/1153">#1153</a>.</p>

<p>Here is an example:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">logo</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./logo.png</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// Tell Webpack this JS file uses this image</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">logo</span><span class="p">);</span> <span class="c1">// /logo.84287d09.png</span>

<span class="kd">function</span> <span class="nx">Header</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Import result is the URL of your image</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">logo</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="dl">"</span><span class="s2">Logo</span><span class="dl">"</span> <span class="o">/&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Header</span><span class="p">;</span>
</code></pre></div>
<p>This ensures that when the project is built, Webpack will correctly move the images into the build folder, and provide us with correct paths.</p>

<p>Webpack finds all relative module references in CSS (they start with <code>./</code>) and replaces them with the final paths from the compiled bundle. If you make a typo or accidentally delete an important file, you will see a compilation error, just like when you import a non-existent JavaScript module. The final filenames in the compiled bundle are generated by Webpack from content hashes. If the file content changes in the future, Webpack will give it a different name in production so you don’t need to worry about long-term caching of assets.</p>

<p>Please be advised that this is also a custom feature of Webpack.</p>

<p><strong>It is not required for React</strong> but many people enjoy it (and React Native uses a similar mechanism for images).<br>
An alternative way of handling static assets is described in the next section.</p>
<h2 id='using-the-public-folder'>Using the <code>public</code> Folder</h2>
<blockquote>
<p>Note: this feature is available with <code>react-scripts@0.5.0</code> and higher.</p>
</blockquote>
<h3 id='changing-the-html'>Changing the HTML</h3>
<p>The <code>public</code> folder contains the HTML file so you can tweak it, for example, to <a href="#changing-the-page-title">set the page title</a>.
The <code>&lt;script&gt;</code> tag with the compiled code will be added to it automatically during the build process.</p>
<h3 id='adding-assets-outside-of-the-module-system'>Adding Assets Outside of the Module System</h3>
<p>You can also add other assets to the <code>public</code> folder.</p>

<p>Note that we normally encourage you to <code>import</code> assets in JavaScript files instead.
For example, see the sections on <a href="#adding-a-stylesheet">adding a stylesheet</a> and <a href="#adding-images-fonts-and-files">adding images and fonts</a>.
This mechanism provides a number of benefits:</p>

<ul>
<li>Scripts and stylesheets get minified and bundled together to avoid extra network requests.</li>
<li>Missing files cause compilation errors instead of 404 errors for your users.</li>
<li>Result filenames include content hashes so you don’t need to worry about browsers caching their old versions.</li>
</ul>

<p>However there is an <strong>escape hatch</strong> that you can use to add an asset outside of the module system.</p>

<p>If you put a file into the <code>public</code> folder, it will <strong>not</strong> be processed by Webpack. Instead it will be copied into the build folder untouched. To reference assets in the <code>public</code> folder, you need to use a special variable called <code>PUBLIC_URL</code>.</p>

<p>Inside <code>index.html</code>, you can use it like this:</p>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"shortcut icon"</span> <span class="na">href=</span><span class="s">"%PUBLIC_URL%/favicon.ico"</span><span class="nt">&gt;</span>
</code></pre></div>
<p>Only files inside the <code>public</code> folder will be accessible by <code>%PUBLIC_URL%</code> prefix. If you need to use a file from <code>src</code> or <code>node_modules</code>, you’ll have to copy it there to explicitly specify your intention to make this file a part of the build.</p>

<p>When you run <code>npm run build</code>, Create React App will substitute <code>%PUBLIC_URL%</code> with a correct absolute path so your project works even if you use client-side routing or host it at a non-root URL.</p>

<p>In JavaScript code, you can use <code>process.env.PUBLIC_URL</code> for similar purposes:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Note: this is an escape hatch and should be used sparingly!</span>
  <span class="c1">// Normally we recommend using `import` for getting asset URLs</span>
  <span class="c1">// as described in “Adding Images and Fonts” above this section.</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PUBLIC_URL</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/img/logo.png</span><span class="dl">'</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span><span class="p">}</span>
</code></pre></div>
<p>Keep in mind the downsides of this approach:</p>

<ul>
<li>None of the files in <code>public</code> folder get post-processed or minified.</li>
<li>Missing files will not be called at compilation time, and will cause 404 errors for your users.</li>
<li>Result filenames won’t include content hashes so you’ll need to add query arguments or rename them every time they change.</li>
</ul>
<h3 id='when-to-use-the-public-folder'>When to Use the <code>public</code> Folder</h3>
<p>Normally we recommend importing <a href="#adding-a-stylesheet">stylesheets</a>, <a href="#adding-images-fonts-and-files">images, and fonts</a> from JavaScript.
The <code>public</code> folder is useful as a workaround for a number of less common cases:</p>

<ul>
<li>You need a file with a specific name in the build output, such as <a href="https://developer.mozilla.org/en-US/docs/Web/Manifest"><code>manifest.webmanifest</code></a>.</li>
<li>You have thousands of images and need to dynamically reference their paths.</li>
<li>You want to include a small script like <a href="http://github.hubspot.com/pace/docs/welcome/"><code>pace.js</code></a> outside of the bundled code.</li>
<li>Some library may be incompatible with Webpack and you have no other option but to include it as a <code>&lt;script&gt;</code> tag.</li>
</ul>

<p>Note that if you add a <code>&lt;script&gt;</code> that declares global variables, you also need to read the next section on using them.</p>
<h2 id='using-global-variables'>Using Global Variables</h2>
<p>When you include a script in the HTML file that defines global variables and try to use one of these variables in the code, the linter will complain because it cannot see the definition of the variable.</p>

<p>You can avoid this by reading the global variable explicitly from the <code>window</code> object, for example:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">$</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">$</span><span class="p">;</span>
</code></pre></div>
<p>This makes it obvious you are using a global variable intentionally rather than because of a typo.</p>

<p>Alternatively, you can force the linter to ignore any line by adding <code>// eslint-disable-line</code> after it.</p>
<h2 id='using-https-in-development'>Using HTTPS in Development</h2>
<blockquote>
<p>Note: this feature is available with <code>react-scripts@0.4.0</code> and higher.</p>
</blockquote>

<p>You may require the dev server to serve pages over HTTPS. One particular case where this could be useful is when using <a href="#proxying-api-requests-in-development">the &quot;proxy&quot; feature</a> to proxy requests to an API server when that API server is itself serving HTTPS.</p>

<p>To do this, set the <code>HTTPS</code> environment variable to <code>true</code>, then start the dev server as usual with <code>npm start</code></p>
<h4 id='windows-cmd-exe'>Windows (cmd.exe)</h4><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">set </span><span class="nv">HTTPS</span><span class="o">=</span><span class="nb">true</span><span class="o">&amp;&amp;</span>npm start
</code></pre></div>
<p>(Note: the lack of whitespace is intentional.)</p>
<h4 id='linux-macos-bash'>Linux, macOS (Bash)</h4><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nv">HTTPS</span><span class="o">=</span><span class="nb">true </span>npm start
</code></pre></div>
<p>Note that the server will use a self-signed certificate, so your web browser will almost definitely display a warning upon accessing the page.</p>
<h2 id='running-tests'>Running Tests</h2>
<blockquote>
<p>Note: this feature is available with <code>react-scripts@0.3.0</code> and higher.<br> &gt;<a href="https://github.com/facebookincubator/create-react-app/blob/master/CHANGELOG.md#migrating-from-023-to-030">Read the migration guide to learn how to enable it in older projects!</a></p>
</blockquote>

<p>Create React App uses <a href="https://facebook.github.io/jest/">Jest</a> as its test runner. To prepare for this integration, we did a <a href="https://facebook.github.io/jest/blog/2016/09/01/jest-15.html">major revamp</a> of Jest so if you heard bad things about it years ago, give it another try.</p>

<p>Jest is a Node-based runner. This means that the tests always run in a Node environment and not in a real browser. This lets us enable fast iteration speed and prevent flakiness.</p>

<p>While Jest provides browser globals such as <code>window</code> thanks to <a href="https://github.com/tmpvar/jsdom">jsdom</a>, they are only approximations of the real browser behavior. Jest is intended to be used for unit tests of your logic and your components rather than the DOM quirks.</p>

<p>We recommend that you use a separate tool for browser end-to-end tests if you need them. They are beyond the scope of Create React App.</p>
<h3 id='filename-conventions'>Filename Conventions</h3>
<p>Jest will look for test files with any of the following popular naming conventions:</p>

<ul>
<li>Files with <code>.js</code> suffix in <code>__tests__</code> folders.</li>
<li>Files with <code>.test.js</code> suffix.</li>
<li>Files with <code>.spec.js</code> suffix.</li>
</ul>

<p>The <code>.test.js</code> / <code>.spec.js</code> files (or the <code>__tests__</code> folders) can be located at any depth under the <code>src</code> top level folder.</p>

<p>We recommend to put the test files (or <code>__tests__</code> folders) next to the code they are testing so that relative imports appear shorter. For example, if <code>App.test.js</code> and <code>App.js</code> are in the same folder, the test just needs to <code>import App from &#39;./App&#39;</code> instead of a long relative path. Colocation also helps find tests more quickly in larger projects.</p>
<h3 id='command-line-interface'>Command Line Interface</h3>
<p>When you run <code>npm test</code>, Jest will launch in the watch mode. Every time you save a file, it will re-run the tests, just like <code>npm start</code> recompiles the code.</p>

<p>The watcher includes an interactive command-line interface with the ability to run all tests, or focus on a search pattern. It is designed this way so that you can keep it open and enjoy fast re-runs. You can learn the commands from the “Watch Usage” note that the watcher prints after every run:</p>

<p><img src="http://facebook.github.io/jest/img/blog/15-watch.gif" alt="Jest watch mode" /></p>
<h3 id='version-control-integration'>Version Control Integration</h3>
<p>By default, when you run <code>npm test</code>, Jest will only run the tests related to files changed since the last commit. This is an optimization designed to make your tests run fast regardless of how many tests you have. However it assumes that you don’t often commit the code that doesn’t pass the tests.</p>

<p>Jest will always explicitly mention that it only ran tests related to the files changed since the last commit. You can also press <code>a</code> in the watch mode to force Jest to run all tests.</p>

<p>Jest will always run all tests on a <a href="#continuous-integration">continuous integration</a> server or if the project is not inside a Git or Mercurial repository.</p>
<h3 id='writing-tests'>Writing Tests</h3>
<p>To create tests, add <code>it()</code> (or <code>test()</code>) blocks with the name of the test and its code. You may optionally wrap them in <code>describe()</code> blocks for logical grouping but this is neither required nor recommended.</p>

<p>Jest provides a built-in <code>expect()</code> global function for making assertions. A basic test could look like this:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="nx">sum</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./sum</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">sums numbers</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)).</span><span class="nx">toEqual</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)).</span><span class="nx">toEqual</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>All <code>expect()</code> matchers supported by Jest are <a href="https://facebook.github.io/jest/docs/en/expect.html#content">extensively documented here</a>.<br>
You can also use <a href="https://facebook.github.io/jest/docs/en/expect.html#tohavebeencalled"><code>jest.fn()</code> and <code>expect(fn).toBeCalled()</code></a> to create “spies” or mock functions.</p>
<h3 id='testing-components'>Testing Components</h3>
<p>There is a broad spectrum of component testing techniques. They range from a “smoke test” verifying that a component renders without throwing, to shallow rendering and testing some of the output, to full rendering and testing component lifecycle and state changes.</p>

<p>Different projects choose different testing tradeoffs based on how often components change, and how much logic they contain. If you haven’t decided on a testing strategy yet, we recommend that you start with creating simple smoke tests for your components:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./App</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">renders without crashing</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nx">div</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>This test mounts a component and makes sure that it didn’t throw during rendering. Tests like this provide a lot value with very little effort so they are great as a starting point, and this is the test you will find in <code>src/App.test.js</code>.</p>

<p>When you encounter bugs caused by changing components, you will gain a deeper insight into which parts of them are worth testing in your application. This might be a good time to introduce more specific tests asserting specific expected output or behavior.</p>

<p>If you’d like to test components in isolation from the child components they render, we recommend using <a href="http://airbnb.io/enzyme/docs/api/shallow.html"><code>shallow()</code> rendering API</a> from <a href="http://airbnb.io/enzyme/">Enzyme</a>. To install it, run:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>npm <span class="nb">install</span> <span class="nt">--save</span> enzyme enzyme-adapter-react-16 react-test-renderer
</code></pre></div>
<p>Alternatively you may use <code>yarn</code>:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn add enzyme enzyme-adapter-react-16 react-test-renderer
</code></pre></div>
<p>As of Enzyme 3, you will need to install Enzyme along with an Adapter corresponding to the version of React you are using. (The examples above use the adapter for React 16.)</p>

<p>The adapter will also need to be configured in your <a href="#initializing-test-environment">global setup file</a>:</p>
<h4 id='src-setuptests-js'><code>src/setupTests.js</code></h4><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">configure</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">enzyme</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Adapter</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">enzyme-adapter-react-16</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">configure</span><span class="p">({</span> <span class="na">adapter</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Adapter</span><span class="p">()</span> <span class="p">});</span>
</code></pre></div>
<p>Now you can write a smoke test with it:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">shallow</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">enzyme</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./App</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">renders without crashing</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>Unlike the previous smoke test using <code>ReactDOM.render()</code>, this test only renders <code>&lt;App&gt;</code> and doesn’t go deeper. For example, even if <code>&lt;App&gt;</code> itself renders a <code>&lt;Button&gt;</code> that throws, this test will pass. Shallow rendering is great for isolated unit tests, but you may still want to create some full rendering tests to ensure the components integrate correctly. Enzyme supports <a href="http://airbnb.io/enzyme/docs/api/mount.html">full rendering with <code>mount()</code></a>, and you can also use it for testing state changes and component lifecycle.</p>

<p>You can read the <a href="http://airbnb.io/enzyme/">Enzyme documentation</a> for more testing techniques. Enzyme documentation uses Chai and Sinon for assertions but you don’t have to use them because Jest provides built-in <code>expect()</code> and <code>jest.fn()</code> for spies.</p>

<p>Here is an example from Enzyme documentation that asserts specific output, rewritten to use Jest matchers:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">shallow</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">enzyme</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./App</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">renders welcome message</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">welcome</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">React</span><span class="o">&lt;</span><span class="sr">/h2&gt;</span><span class="err">;
</span>  <span class="c1">// expect(wrapper.contains(welcome)).to.equal(true);</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">welcome</span><span class="p">)).</span><span class="nx">toEqual</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>All Jest matchers are <a href="http://facebook.github.io/jest/docs/en/expect.html">extensively documented here</a>.<br>
Nevertheless you can use a third-party assertion library like <a href="http://chaijs.com/">Chai</a> if you want to, as described below.</p>

<p>Additionally, you might find <a href="https://github.com/blainekasten/enzyme-matchers">jest-enzyme</a> helpful to simplify your tests with readable matchers. The above <code>contains</code> code can be written simpler with jest-enzyme.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">).</span><span class="nx">toContainReact</span><span class="p">(</span><span class="nx">welcome</span><span class="p">);</span>
</code></pre></div>
<p>To enable this, install <code>jest-enzyme</code>:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>npm <span class="nb">install</span> <span class="nt">--save</span> jest-enzyme
</code></pre></div>
<p>Alternatively you may use <code>yarn</code>:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn add jest-enzyme
</code></pre></div>
<p>Import it in <a href="#initializing-test-environment"><code>src/setupTests.js</code></a> to make its matchers available in every test:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">jest-enzyme</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div><h3 id='using-third-party-assertion-libraries'>Using Third Party Assertion Libraries</h3>
<p>We recommend that you use <code>expect()</code> for assertions and <code>jest.fn()</code> for spies. If you are having issues with them please <a href="https://github.com/facebook/jest/issues/new">file those against Jest</a>, and we’ll fix them. We intend to keep making them better for React, supporting, for example, <a href="https://github.com/facebook/jest/pull/1566">pretty-printing React elements as JSX</a>.</p>

<p>However, if you are used to other libraries, such as <a href="http://chaijs.com/">Chai</a> and <a href="http://sinonjs.org/">Sinon</a>, or if you have existing code using them that you’d like to port over, you can import them normally like this:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">import</span> <span class="nx">sinon</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">sinon</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">expect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">chai</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div>
<p>and then use them in your tests like you normally do.</p>
<h3 id='initializing-test-environment'>Initializing Test Environment</h3>
<blockquote>
<p>Note: this feature is available with <code>react-scripts@0.4.0</code> and higher.</p>
</blockquote>

<p>If your app uses a browser API that you need to mock in your tests or if you just need a global setup before running your tests, add a <code>src/setupTests.js</code> to your project. It will be automatically executed before running your tests.</p>

<p>For example:</p>
<h4 id='src-setuptests-js-2'><code>src/setupTests.js</code></h4><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">localStorageMock</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">getItem</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">(),</span>
  <span class="na">setItem</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">(),</span>
  <span class="na">clear</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="p">};</span>
<span class="nb">global</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">=</span> <span class="nx">localStorageMock</span><span class="p">;</span>
</code></pre></div><h3 id='focusing-and-excluding-tests'>Focusing and Excluding Tests</h3>
<p>You can replace <code>it()</code> with <code>xit()</code> to temporarily exclude a test from being executed.<br>
Similarly, <code>fit()</code> lets you focus on a specific test without running any other tests.</p>
<h3 id='coverage-reporting'>Coverage Reporting</h3>
<p>Jest has an integrated coverage reporter that works well with ES6 and requires no configuration.<br>
Run <code>npm test -- --coverage</code> (note extra <code>--</code> in the middle) to include a coverage report like this:</p>

<p><img src="http://i.imgur.com/5bFhnTS.png" alt="coverage report" /></p>

<p>Note that tests run much slower with coverage so it is recommended to run it separately from your normal workflow.</p>
<h4 id='configuration'>Configuration</h4>
<p>The default Jest coverage configuration can be overriden by adding any of the following supported keys to a Jest config in your package.json.</p>

<p>Supported overrides:</p>

<ul>
<li><a href="https://facebook.github.io/jest/docs/en/configuration.html#collectcoveragefrom-array"><code>collectCoverageFrom</code></a></li>
<li><a href="https://facebook.github.io/jest/docs/en/configuration.html#coveragereporters-array-string"><code>coverageReporters</code></a></li>
<li><a href="https://facebook.github.io/jest/docs/en/configuration.html#coveragethreshold-object"><code>coverageThreshold</code></a></li>
<li><a href="https://facebook.github.io/jest/docs/en/configuration.html#snapshotserializers-array-string"><code>snapshotSerializers</code></a></li>
</ul>

<p>Example package.json:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">your-package</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">jest</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">collectCoverageFrom</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
      <span class="dl">"</span><span class="s2">src/**/*.{js,jsx}</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">!&lt;rootDir&gt;/node_modules/</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">!&lt;rootDir&gt;/path/to/dir/</span><span class="dl">"</span>
    <span class="p">],</span>
    <span class="dl">"</span><span class="s2">coverageThreshold</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">global</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">branches</span><span class="dl">"</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">functions</span><span class="dl">"</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">lines</span><span class="dl">"</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">statements</span><span class="dl">"</span><span class="p">:</span> <span class="mi">90</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">coverageReporters</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">],</span>
    <span class="dl">"</span><span class="s2">snapshotSerializers</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">my-serializer-module</span><span class="dl">"</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id='continuous-integration'>Continuous Integration</h3>
<p>By default <code>npm test</code> runs the watcher with interactive CLI. However, you can force it to run tests once and finish the process by setting an environment variable called <code>CI</code>.</p>

<p>When creating a build of your application with <code>npm run build</code> linter warnings are not checked by default. Like <code>npm test</code>, you can force the build to perform a linter warning check by setting the environment variable <code>CI</code>. If any warnings are encountered then the build fails.</p>

<p>Popular CI servers already set the environment variable <code>CI</code> by default but you can do this yourself too:</p>
<h3 id='on-ci-servers'>On CI servers</h3><h4 id='travis-ci'>Travis CI</h4>
<ol>
<li>Following the <a href="https://docs.travis-ci.com/user/getting-started/">Travis Getting started</a> guide for syncing your GitHub repository with Travis. You may need to initialize some settings manually in your <a href="https://travis-ci.org/profile">profile</a> page.</li>
<li>Add a <code>.travis.yml</code> file to your git repository.</li>
</ol>
<div class="highlight"><pre class="highlight docker tab-docker"><code>language: node_js
node_js:
  - 6
cache:
  directories:
    - node_modules
script:
  - npm run build
  - npm test
</code></pre></div>
<ol>
<li>Trigger your first build with a git push.</li>
<li><a href="https://docs.travis-ci.com/user/customizing-the-build/">Customize your Travis CI Build</a> if needed.</li>
</ol>
<h4 id='circleci'>CircleCI</h4>
<p>Follow <a href="https://medium.com/@knowbody/circleci-and-zeits-now-sh-c9b7eebcd3c1">this article</a> to set up CircleCI with a Create React App project.</p>
<h3 id='on-your-own-environment'>On your own environment</h3><h4 id='windows-cmd-exe-2'>Windows (cmd.exe)</h4><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">set </span><span class="nv">CI</span><span class="o">=</span><span class="nb">true</span><span class="o">&amp;&amp;</span>npm <span class="nb">test</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">set </span><span class="nv">CI</span><span class="o">=</span><span class="nb">true</span><span class="o">&amp;&amp;</span>npm run build
</code></pre></div>
<p>(Note: the lack of whitespace is intentional.)</p>
<h4 id='linux-macos-bash-2'>Linux, macOS (Bash)</h4><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nv">CI</span><span class="o">=</span><span class="nb">true </span>npm <span class="nb">test</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nv">CI</span><span class="o">=</span><span class="nb">true </span>npm run build
</code></pre></div>
<p>The test command will force Jest to run tests once instead of launching the watcher.</p>

<blockquote>
<p>If you find yourself doing this often in development, please <a href="https://github.com/facebookincubator/create-react-app/issues/new">file an issue</a> to tell us about your use case because we want to make watcher the best experience and are open to changing how it works to accommodate more workflows.</p>
</blockquote>

<p>The build command will check for linter warnings and fail if any are found.</p>
<h3 id='disabling-jsdom'>Disabling jsdom</h3>
<p>By default, the <code>package.json</code> of the generated project looks like this:</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>  <span class="dl">"</span><span class="s2">scripts</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">start</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">react-scripts start</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">build</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">react-scripts build</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">test</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">react-scripts test --env=jsdom</span><span class="dl">"</span>
</code></pre></div>
<p>If you know that none of your tests depend on <a href="https://github.com/tmpvar/jsdom">jsdom</a>, you can safely remove <code>--env=jsdom</code>, and your tests will run faster:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>  <span class="s2">"scripts"</span>: <span class="o">{</span>
    <span class="s2">"start"</span>: <span class="s2">"react-scripts start"</span>,
    <span class="s2">"build"</span>: <span class="s2">"react-scripts build"</span>,
-   <span class="s2">"test"</span>: <span class="s2">"react-scripts test --env=jsdom"</span>
+   <span class="s2">"test"</span>: <span class="s2">"react-scripts test"</span>
</code></pre></div>
<p>To help you make up your mind, here is a list of APIs that <strong>need jsdom</strong>:</p>

<ul>
<li>Any browser globals like <code>window</code> and <code>document</code></li>
<li><a href="https://facebook.github.io/react/docs/top-level-api.html#reactdom.render"><code>ReactDOM.render()</code></a></li>
<li><a href="https://facebook.github.io/react/docs/test-utils.html#renderintodocument"><code>TestUtils.renderIntoDocument()</code></a> (<a href="https://github.com/facebook/react/blob/34761cf9a252964abfaab6faf74d473ad95d1f21/src/test/ReactTestUtils.js#L83-L91">a shortcut</a> for the above)</li>
<li><a href="http://airbnb.io/enzyme/docs/api/mount.html"><code>mount()</code></a> in <a href="http://airbnb.io/enzyme/index.html">Enzyme</a></li>
</ul>

<p>In contrast, <strong>jsdom is not needed</strong> for the following APIs:</p>

<ul>
<li><a href="https://facebook.github.io/react/docs/test-utils.html#shallow-rendering"><code>TestUtils.createRenderer()</code></a> (shallow rendering)</li>
<li><a href="http://airbnb.io/enzyme/docs/api/shallow.html"><code>shallow()</code></a> in <a href="http://airbnb.io/enzyme/index.html">Enzyme</a></li>
</ul>

<p>Finally, jsdom is also not needed for <a href="http://facebook.github.io/jest/blog/2016/07/27/jest-14.html">snapshot testing</a>.</p>
<h3 id='snapshot-testing'>Snapshot Testing</h3>
<p>Snapshot testing is a feature of Jest that automatically generates text snapshots of your components and saves them on the disk so if the UI output changes, you get notified without manually writing any assertions on the component output. <a href="http://facebook.github.io/jest/blog/2016/07/27/jest-14.html">Read more about snapshot testing.</a></p>
<h3 id='editor-integration'>Editor Integration</h3>
<p>If you use <a href="https://code.visualstudio.com">Visual Studio Code</a>, there is a <a href="https://github.com/orta/vscode-jest">Jest extension</a> which works with Create React App out of the box. This provides a lot of IDE-like features while using a text editor: showing the status of a test run with potential fail messages inline, starting and stopping the watcher automatically, and offering one-click snapshot updates.</p>

<p><img src="https://cloud.githubusercontent.com/assets/49038/20795349/a032308a-b7c8-11e6-9b34-7eeac781003f.png" alt="VS Code Jest Preview" /></p>
<h2 id='analyzing-the-bundle-size'>Analyzing the Bundle Size</h2>
<p><a href="https://www.npmjs.com/package/source-map-explorer">Source map explorer</a> analyzes
JavaScript bundles using the source maps. This helps you understand where code
bloat is coming from.</p>

<p>To add Source map explorer to a Create React App project, follow these steps:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>npm <span class="nb">install</span> <span class="nt">--save</span> source-map-explorer
</code></pre></div>
<p>Alternatively you may use <code>yarn</code>:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>yarn add source-map-explorer
</code></pre></div>
<p>Then in <code>package.json</code>, add the following line to <code>scripts</code>:</p>
<div class="highlight"><pre class="highlight diff tab-diff"><code>   "scripts": {
<span class="gi">+    "analyze": "source-map-explorer build/static/js/main.*",
</span>     "start": "react-scripts start",
     "build": "react-scripts build",
     "test": "react-scripts test --env=jsdom",
</code></pre></div>
<p>Then to analyze the bundle run the production build then run the analyze
script.</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>npm run build
npm run analyze
</code></pre></div><h2 id='advanced-configuration'>Advanced Configuration</h2>
<p>You can adjust various development and production settings by setting environment variables in your shell or with <a href="#adding-development-environment-variables-in-env">.env</a>.</p>

<p>| Variable            |      Development       |     Production     | Usage
| BROWSER             |   :white_check_mark:   |        :x:         | By default, Create React App will open the default system browser, favoring Chrome on macOS. Specify a <a href="https://github.com/sindresorhus/opn#app">browser</a> to override this behavior, or set it to <code>none</code> to disable it completely. If you need to customize the way the browser is launched, you can specify a node script instead. Any arguments passed to <code>npm start</code> will also be passed to this script, and the url where your app is served will be the last argument. Your script&#39;s file name must have the <code>.js</code> extension.|</p>

<p>| HOST                |   :white_check_mark:   |        :x:         | By default, the development web server binds to <code>localhost</code>. You may use this variable to specify a different host.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| PORT                |   :white_check_mark:   |        :x:         | By default, the development web server will attempt to listen on port 3000 or prompt you to attempt the next available port. You may use this variable to specify a different port.                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| HTTPS               |   :white_check_mark:   |        :x:         | When set to <code>true</code>, Create React App will run the development server in <code>https</code> mode.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PUBLIC_URL          |          :x:           | :white_check_mark: | Create React App assumes your application is hosted at the serving web server&#39;s root or a subpath as specified in <a href="#building-for-relative-paths"><code>package.json</code> (<code>homepage</code>)</a>. Normally, Create React App ignores the hostname. You may use this variable to force assets to be referenced verbatim to the url you provide (hostname included). This may be particularly useful when using a CDN to host your application.                                                                                                                                                                                                |
| CI                  | :large_orange_diamond: | :white_check_mark: | When set to <code>true</code>, Create React App treats warnings as failures in the build. It also makes the test runner non-watching. Most CIs set this flag by default.                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| REACT_EDITOR        |   :white_check_mark:   |        :x:         | When an app crashes in development, you will see an error overlay with clickable stack trace. When you click on it, Create React App will try to determine the editor you are using based on currently running processes, and open the relevant source file. You can <a href="https://github.com/facebookincubator/create-react-app/issues/2636">send a pull request to detect your editor of choice</a>. Setting this environment variable overrides the automatic detection. If you do it, make sure your systems <a href="https://en.wikipedia.org/wiki/PATH_(variable)">PATH</a> environment variable points to your editor’s bin folder. |</p>

<p>| CHOKIDAR_USEPOLLING |   :white_check_mark:   |        :x:         | When set to <code>true</code>, the watcher runs in polling mode, as necessary inside a VM. Use this option if <code>npm start</code> isn&#39;t detecting changes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| GENERATE_SOURCEMAP  |          :x:           | :white_check_mark: | When set to <code>false</code>, source maps are not generated for a production build. This solves OOM issues on some smaller machines. |</p>
<h2 id='troubleshooting'>Troubleshooting</h2><h3 id='npm-start-doesn-t-detect-changes'><code>npm start</code> doesn’t detect changes</h3>
<p>When you save a file while <code>npm start</code> is running, the browser should refresh with the updated code.<br>
If this doesn’t happen, try one of the following workarounds:</p>

<ul>
<li><p>If your project is in a Dropbox folder, try moving it out.</p></li>
<li><p>If the watcher doesn’t see a file called <code>index.js</code> and you’re referencing it by the folder name, you <a href="https://github.com/facebookincubator/create-react-app/issues/1164">need to restart the 
watcher</a> due to a Webpack bug.</p></li>
<li><p>Some editors like Vim and IntelliJ have a “safe write” feature that currently breaks the watcher. You will need to disable it. 
Follow the instructions in <a href="https://webpack.js.org/guides/development/#adjusting-your-text-editor">“Adjusting Your Text Editor”</a>.</p></li>
<li><p>If your project path contains parentheses, try moving the project to a path without them. This is caused by a <a href="https://github.com/webpack/watchpack/issues/42">Webpack watcher 
bug</a>.</p></li>
<li><p>On Linux and macOS, you might need to <a href="https://webpack.github.io/docs/troubleshooting.
html#not-enough-watchers">tweak system settings</a> to allow more watchers.</p></li>
<li><p>If the project runs inside a virtual machine such as (a Vagrant provisioned) VirtualBox, create an <code>.env</code> file in your project 
directory if it doesn’t exist, and add <code>CHOKIDAR_USEPOLLING=true</code> to it. This ensures that the next time you run <code>npm start</code>, the watcher uses the polling mode, as necessary inside a VM.</p></li>
</ul>

<p>If none of these solutions help please leave a comment <a href="https://github.com/facebookincubator/create-react-app/issues/659">in this thread</a>.</p>
<h3 id='npm-test-hangs-on-macos-sierra'><code>npm test</code> hangs on macOS Sierra</h3>
<p>If you run <code>npm test</code> and the console gets stuck after printing <code>react-scripts test --env=jsdom</code> to the console there might be a problem with your <a href="https://facebook.github.io/watchman/">Watchman</a> installation as described in <a href="https://github.com/facebookincubator/create-react-app/issues/713">facebookincubator/create-react-app#713</a>.</p>

<p>We recommend deleting <code>node_modules</code> in your project and running <code>npm install</code> (or <code>yarn</code> if you use it) first. If it doesn&#39;t help, you can try one of the numerous workarounds mentioned in these issues:</p>

<ul>
<li><a href="https://github.com/facebook/jest/issues/1767">facebook/jest#1767</a></li>
<li><a href="https://github.com/facebook/watchman/issues/358">facebook/watchman#358</a></li>
<li><a href="https://github.com/ember-cli/ember-cli/issues/6259">ember-cli/ember-cli#6259</a></li>
</ul>

<p>It is reported that installing Watchman 4.7.0 or newer fixes the issue. If you use <a href="http://brew.sh/">Homebrew</a>, you can run these commands to update it:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>watchman shutdown-server
brew update
brew reinstall watchman
</code></pre></div>
<p>You can find <a href="https://facebook.github.io/watchman/docs/install.html#build-install">other installation methods</a> on the Watchman documentation page.</p>

<p>If this still doesn’t help, try running <code>launchctl unload -F ~/Library/LaunchAgents/com.github.facebook.watchman.plist</code>.</p>

<p>There are also reports that <em>uninstalling</em> Watchman fixes the issue. So if nothing else helps, remove it from your system and try again.</p>
<h3 id='npm-run-build-exits-too-early'><code>npm run build</code> exits too early</h3>
<p>It is reported that <code>npm run build</code> can fail on machines with limited memory and no swap space, which is common in cloud environments. Even with small projects this command can increase RAM usage in your system by hundreds of megabytes, so if you have less than 1 GB of available memory your build is likely to fail with the following message:</p>

<blockquote>
<p>The build failed because the process exited too early. This probably means the system ran out of memory or someone called <code>kill -9</code> on the process.</p>
</blockquote>

<p>If you are completely sure that you didn&#39;t terminate the process, consider <a href="https://www.digitalocean.com/community/tutorials/how-to-add-swap-on-ubuntu-14-04">adding some swap space</a> to the machine you’re building on, or build the project locally.</p>
<h3 id='npm-run-build-fails-to-minify'><code>npm run build</code> fails to minify</h3>
<p>Some third-party packages don&#39;t compile their code to ES5 before publishing to npm. This often causes problems in the ecosystem because neither browsers (except for most modern versions) nor some tools currently support all ES6 features. We recommend to publish code on npm as ES5 at least for a few more years.</p>

<p><br>
To resolve this:</p>

<ol>
<li>Open an issue on the dependency&#39;s issue tracker and ask that the package be published pre-compiled.</li>
</ol>

<ul>
<li>Note: Create React App can consume both CommonJS and ES modules. For Node.js compatibility, it is recommended that the main entry point is CommonJS. However, they can optionally provide an ES module entry point with the <code>module</code> field in <code>package.json</code>. Note that <strong>even if a library provides an ES Modules version, it should still precompile other ES6 features to ES5 if it intends to support older browsers</strong>.</li>
</ul>

<ol>
<li><p>Fork the package and publish a corrected version yourself.</p></li>
<li><p>If the dependency is small enough, copy it to your <code>src/</code> folder and treat it as application code.</p></li>
</ol>

<p>In the future, we might start automatically compiling incompatible third-party modules, but it is not currently supported. This approach would also slow down the production builds.</p>
<h1 id='react-scripts'>React scripts</h1>
<p>This package includes scripts and configuration used by <a href="https://github.com/facebook/create-react-app">Create React App</a>.<br>
Please refer to its documentation:</p>

<ul>
<li><a href="https://github.com/facebook/create-react-app/blob/master/README.md#getting-started">Getting Started</a> – How to create a new app.</li>
<li><a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md">User Guide</a> – How to develop apps bootstrapped with Create React App.</li>
</ul>
<h1 id='enviroments'>Enviroments</h1>
<p>Most secrets and domain specfic values are managed with various .env files 
in <code>royal-web/env</code>
Env files are used as global variables with domain specific values to control features that are used in some domains</p>

<p>values in these files can be passed into the client side of the applications by using the prefix <code>REACT_APP</code></p>

<p>ex: <code>REACT_APP_TRUSTPILOT_LINK=https://no.trustpilot.com/</code></p>

<p>prod/ = production enviroments
stage/ = development enviroments</p>

<p>shared enviroment variables (non domain specific) are placed in files named <code>common</code></p>

<p>each application also has a local .env is used for local development the local .env file override the others during development. </p>

<p>enviroment files found in 
```shell
Project root/
   env/
      r21/
         prod/
         stage/</p>

<p>royaldesign/
         prod/
         stage/
``<code>
for each domain there is a corresponding .env file in both</code>prod/<code>and</code>stage/`</p>
<h1 id='meta-tags'>Meta tags</h1><h2 id='head'>Head</h2><h3 id='tags'>Tags</h3>
<p>Site verification tags such as 
with the syntax <code>&lt;meta name=&quot;X-domain-verification&quot; content=&quot;some-string-123&quot; /&gt;</code>
with different identifiers for each domain lives in:</p>

<p><a href="https://prismic.io/dashboard">Prismic</a> &gt; 
        (Section type:) Document &gt; 
             (Document name:) Config or Configuration &gt; 
                    (Subsection name:) SEO &gt; 
                        (Slice tab name) Meta tags</p>

<p>exeception from above is when a tag is to be implemented on the domain <link>https://Royaldesign.com</link> which is hardcoded in the project <code>royal-web</code> and then the file:
<code>royal-web/packages/royaldesign/public/countries.html</code></p>
<h2 id='google-tag-mananger-gtm'>Google tag mananger - GTM</h2>
<p>Most scripts related to tracking or external services lives in <a href="https://tagmanager.google.com/">google tag mananger</a> where there is two accounts <code>Dev</code> which is the development enviroment connected to the stage build enviroments and <code>new site</code> which is connected to the production enviroments</p>
<h1 id='verify-deploys'>Verify deploys</h1>
<p>Is a very simple bash script that pings all the production enviroment swap slots.
Essentially you run it when your are deploying something new to production the build has been completed and azure devops is ready to swap slots.</p>

<p>This script checks the pre-production enviroment
<code>shell
❯ ./verify-all-deploys.sh
Which site group do you want to test?
         1) Royaldesign
         2) Rum21
         3) Both
         4) Exit                ...
</code>
Where you select 1, 2 or 3</p>
<h1 id='documentation-in-swedish'>Documentation in swedish</h1><h1 id='collector'>Collector</h1><h2 id='i-stage-miljoer'>I stage miljöer</h2>
<p>Postnummer:  53431
Collector:</p>

<p>E-post:             test.user@royaldesign.com
MobilNummer         +4612233123</p>

<p>Sen klickar du på &quot;Fortsätt utan&quot; </p>

<p>Förnamn                Approved16
Efternamn           Sweden16
Adress              MELLANGATAN 3
PostNummer        53431
Ort                 Vara</p>

<p>Sen klickar du på knappen &quot;Spara&quot; och väljer &quot;Kort&quot; betalning</p>

<p>Kortnummer          4571999400007492
utgångsdatum       12/22
Verifieringskod     150</p>

<p>Det borde dyka upp en triangel med utropstecken på höger sidan av kortnummer som informerar om att detta är ett testköp </p>
<h1 id='errors'>Errors</h1>
<aside class="notice">
This error section is stored in a separate file in <code>includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>'s frontmatter. Files are included in the order listed.
</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="html">html</a>
          </div>
      </div>
    </div>
  </body>
</html>
